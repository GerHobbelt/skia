on:
    push:
      tags:
        - "ckia_*"
name: Binaries Release
env:
  CARGO_INCREMENTAL: 0
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Remove Useless Sources
        run: python ckia/rm_useless_src.py

      - name: Package Sources
        shell: bash
        run: |
            mkdir out
            tar --exclude='./.git' --exclude='./out' -czvf ./out/src.tar.gz .

      - name: Upload Assets
        uses: xresloader/upload-to-github-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tags: true
          draft: true
          file: "./out/src.tar.gz"